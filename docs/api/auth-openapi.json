{"openapi":"3.1.0","info":{"title":"Auth Service","description":"Authentication and authorization service for Cryptobot","version":"1.0.0"},"paths":{"/auth/login":{"post":{"tags":["auth"],"summary":"Login","description":"Login with username and password to get access and refresh tokens","operationId":"login_auth_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_auth_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/TokenPairResponse"},{"additionalProperties":true,"type":"object"}],"title":"Response Login Auth Login Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/mfa/verify-login":{"post":{"tags":["auth"],"summary":"Verify Mfa Login","description":"Verify MFA code during login","operationId":"verify_mfa_login_auth_mfa_verify_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenPairResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/mfa/verify-backup":{"post":{"tags":["auth"],"summary":"Verify Backup Login","description":"Verify backup code during login","operationId":"verify_backup_login_auth_mfa_verify_backup_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenPairResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/refresh":{"post":{"tags":["auth"],"summary":"Refresh","description":"Refresh access token using a refresh token","operationId":"refresh_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/logout":{"post":{"tags":["auth"],"summary":"Logout","description":"Logout by revoking tokens","operationId":"logout_auth_logout_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"refresh_token","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/validate":{"get":{"tags":["auth"],"summary":"Validate Token","description":"Validate a token and return user info (for service-to-service auth)","operationId":"validate_token_auth_validate_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenValidationResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/request-reset":{"post":{"tags":["auth"],"summary":"Request Password Reset","description":"Request password reset by email","operationId":"request_password_reset_auth_request_reset_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/reset-password":{"post":{"tags":["auth"],"summary":"Reset Password","description":"Reset password using valid token","operationId":"reset_password_auth_reset_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetConfirm"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/change-password":{"post":{"tags":["auth"],"summary":"Change Password","description":"Change password for current user","operationId":"change_password_auth_change_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePasswordRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/api-keys":{"get":{"tags":["auth"],"summary":"List Api Keys","description":"List API keys for current user","operationId":"list_api_keys_auth_api_keys_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/APIKeyOut"},"type":"array","title":"Response List Api Keys Auth Api Keys Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["auth"],"summary":"Create Api Key","description":"Create a new API key for exchanges","operationId":"create_api_key_auth_api_keys_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__models__user__APIKeyCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__schemas__token__APIKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/api-keys/{key_id}":{"delete":{"tags":["auth"],"summary":"Delete Api Key","description":"Delete an API key","operationId":"delete_api_key_auth_api_keys__key_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"integer","title":"Key Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/mfa/setup":{"post":{"tags":["auth"],"summary":"Setup Mfa","description":"Initiate MFA setup by generating TOTP secret and QR code","operationId":"setup_mfa_auth_mfa_setup_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFASetupResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/mfa/verify":{"post":{"tags":["auth"],"summary":"Verify Mfa","description":"Verify TOTP code to complete MFA setup","operationId":"verify_mfa_auth_mfa_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/mfa/backup-codes":{"get":{"tags":["auth"],"summary":"Get Backup Codes","description":"Generate new backup codes for MFA recovery","operationId":"get_backup_codes_auth_mfa_backup_codes_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFABackupCodesResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/mfa/status":{"get":{"tags":["auth"],"summary":"Get Mfa Status","description":"Get current MFA status","operationId":"get_mfa_status_auth_mfa_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAStatusResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/mfa/enable":{"post":{"tags":["auth"],"summary":"Enable Mfa","description":"Enable or disable MFA","operationId":"enable_mfa_auth_mfa_enable_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAEnableRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/users":{"get":{"tags":["auth"],"summary":"List Users","description":"List all users (admin only)","operationId":"list_users_auth_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/UserOut"},"type":"array","title":"Response List Users Auth Users Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["auth"],"summary":"Create User","description":"Create a new user (admin only)","operationId":"create_user_auth_users_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/users/me":{"get":{"tags":["auth"],"summary":"Get Current User Info","description":"Get current user info","operationId":"get_current_user_info_auth_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/users/{user_id}":{"get":{"tags":["auth"],"summary":"Get User","description":"Get user by ID (admin only)","operationId":"get_user_auth_users__user_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["auth"],"summary":"Update User","description":"Update user (admin only)","operationId":"update_user_auth_users__user_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["auth"],"summary":"Delete User","description":"Delete user (admin only)","operationId":"delete_user_auth_users__user_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/admin/sessions":{"get":{"tags":["admin","admin"],"summary":"List Active Sessions","description":"List all active sessions (optionally filtered by user)","operationId":"list_active_sessions_admin_admin_sessions_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"query","required":false,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SessionOut"},"title":"Response List Active Sessions Admin Admin Sessions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/admin/sessions/terminate":{"post":{"tags":["admin","admin"],"summary":"Terminate Session","description":"Terminate a session by ID","operationId":"terminate_session_admin_admin_sessions_terminate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionTerminate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/admin/admin/sessions/suspicious":{"post":{"tags":["admin","admin"],"summary":"Report Suspicious Activity","description":"Report suspicious session activity","operationId":"report_suspicious_activity_admin_admin_sessions_suspicious_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuspiciousActivityCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api-keys/api-keys":{"get":{"tags":["api-keys","api-keys"],"summary":"List Api Keys","description":"List all API keys for the current user\n\nReturns a list of all API keys owned by the current user,\nincluding active, rotating, and expired keys.","operationId":"list_api_keys_api_keys_api_keys_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyListResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["api-keys","api-keys"],"summary":"Create Api Key","description":"Create a new API key\n\nCreates a new API key for the specified exchange with the given description.\nThe key will expire after the specified number of days (default: 90).","operationId":"create_api_key_api_keys_api_keys_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api-keys/api-keys/rotate":{"post":{"tags":["api-keys","api-keys"],"summary":"Rotate Api Key","description":"Rotate an API key\n\nCreates a new API key to replace the specified key.\nThe old key will remain valid for the specified grace period (default: 24 hours).","operationId":"rotate_api_key_api_keys_api_keys_rotate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyRotate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api-keys/api-keys/revoke":{"post":{"tags":["api-keys","api-keys"],"summary":"Revoke Api Key","description":"Revoke an API key\n\nImmediately invalidates the specified API key.\nThis action cannot be undone.","operationId":"revoke_api_key_api_keys_api_keys_revoke_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyRevoke"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api-keys/api-keys/emergency-revoke":{"post":{"tags":["api-keys","api-keys"],"summary":"Emergency Revoke Api Key","description":"Emergency revocation for compromised API key\n\nImmediately invalidates the specified API key and marks it as compromised.\nThis will trigger security alerts and create a high-severity audit log entry.","operationId":"emergency_revoke_api_key_api_keys_api_keys_emergency_revoke_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyCompromise"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api-keys/api-keys/history/{exchange}":{"get":{"tags":["api-keys","api-keys"],"summary":"Get Api Key History","description":"Get API key version history\n\nReturns the version history of API keys for the specified exchange.","operationId":"get_api_key_history_api_keys_api_keys_history__exchange__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"exchange","in":"path","required":true,"schema":{"type":"string","title":"Exchange"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyHistoryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api-keys/api-keys/expiring":{"get":{"tags":["api-keys","api-keys"],"summary":"Get Expiring Api Keys","description":"Get API keys that are expiring soon\n\nReturns a list of API keys that will expire within the specified number of days.","operationId":"get_expiring_api_keys_api_keys_api_keys_expiring_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","default":7,"title":"Days"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyExpiringResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api-keys/api-keys/{key_id}":{"get":{"tags":["api-keys","api-keys"],"summary":"Get Api Key","description":"Get API key details\n\nReturns detailed information about the specified API key.","operationId":"get_api_key_api_keys_api_keys__key_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api-keys/api-keys/validate":{"post":{"tags":["api-keys","api-keys"],"summary":"Validate Api Key","description":"Validate an API key\n\nChecks if the provided API key is valid and returns its details.\nThis endpoint is primarily for internal service-to-service authentication.","operationId":"validate_api_key_api_keys_api_keys_validate_post","parameters":[{"name":"api_key","in":"query","required":true,"schema":{"type":"string","title":"Api Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIKeyValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"tags":["docs"],"summary":"Redirect To Docs","description":"Redirect to API documentation","operationId":"redirect_to_docs__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"APIKeyCompromise":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"ID of the key to mark as compromised"},"details":{"type":"string","title":"Details","description":"Details about the compromise"}},"type":"object","required":["key_id","details"],"title":"APIKeyCompromise","description":"Request to mark an API key as compromised"},"APIKeyExpiringResponse":{"properties":{"keys":{"items":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"},"type":"array","title":"Keys","description":"List of expiring keys"},"days_threshold":{"type":"integer","title":"Days Threshold","description":"Days threshold used"}},"type":"object","required":["keys","days_threshold"],"title":"APIKeyExpiringResponse","description":"Response containing keys that are expiring soon"},"APIKeyHistoryResponse":{"properties":{"exchange":{"type":"string","title":"Exchange","description":"Exchange name"},"versions":{"items":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"},"type":"array","title":"Versions","description":"List of key versions"},"current_version":{"type":"integer","title":"Current Version","description":"Current active version"}},"type":"object","required":["exchange","versions","current_version"],"title":"APIKeyHistoryResponse","description":"Response containing API key version history"},"APIKeyListResponse":{"properties":{"keys":{"items":{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"},"type":"array","title":"Keys","description":"List of API keys"},"total":{"type":"integer","title":"Total","description":"Total number of keys"},"active":{"type":"integer","title":"Active","description":"Number of active keys"},"rotating":{"type":"integer","title":"Rotating","description":"Number of keys in rotation"},"expiring_soon":{"type":"integer","title":"Expiring Soon","description":"Number of keys expiring within 7 days"}},"type":"object","required":["keys","total","active","rotating","expiring_soon"],"title":"APIKeyListResponse","description":"Response containing a list of API keys"},"APIKeyOut":{"properties":{"description":{"type":"string","title":"Description"},"exchange":{"type":"string","title":"Exchange"},"is_test":{"type":"boolean","title":"Is Test","default":false},"id":{"type":"integer","title":"Id"},"key":{"type":"string","title":"Key"}},"type":"object","required":["description","exchange","id","key"],"title":"APIKeyOut"},"APIKeyRevoke":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"ID of the key to revoke"},"reason":{"type":"string","title":"Reason","description":"Reason for revocation","default":"Manual revocation"}},"type":"object","required":["key_id"],"title":"APIKeyRevoke","description":"Request to revoke an API key"},"APIKeyRotate":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"ID of the key to rotate"},"grace_period_hours":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Grace Period Hours","description":"Hours to keep old key valid","default":24}},"type":"object","required":["key_id"],"title":"APIKeyRotate","description":"Request to rotate an API key"},"APIKeyValidationResponse":{"properties":{"valid":{"type":"boolean","title":"Valid","description":"Whether the key is valid"},"key":{"anyOf":[{"$ref":"#/components/schemas/auth__schemas__api_key__APIKeyResponse"},{"type":"null"}],"description":"Key details if valid"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message","description":"Error message if invalid"}},"type":"object","required":["valid"],"title":"APIKeyValidationResponse","description":"Response for API key validation"},"Body_login_auth_login_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_auth_login_post"},"ChangePasswordRequest":{"properties":{"current_password":{"type":"string","minLength":8,"title":"Current Password"},"new_password":{"type":"string","minLength":8,"title":"New Password"},"confirm_password":{"type":"string","minLength":8,"title":"Confirm Password"}},"type":"object","required":["current_password","new_password","confirm_password"],"title":"ChangePasswordRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"KeyStatus":{"type":"string","enum":["active","rotating","expired","revoked","compromised"],"title":"KeyStatus","description":"API Key status enum"},"MFABackupCodesResponse":{"properties":{"codes":{"items":{"type":"string"},"type":"array","title":"Codes","description":"Newly generated backup codes"}},"type":"object","required":["codes"],"title":"MFABackupCodesResponse","description":"Response containing new backup codes"},"MFAEnableRequest":{"properties":{"enable":{"type":"boolean","title":"Enable","description":"True to enable MFA, False to disable"}},"type":"object","required":["enable"],"title":"MFAEnableRequest","description":"Request to enable/disable MFA"},"MFASetupResponse":{"properties":{"secret":{"type":"string","title":"Secret","description":"TOTP secret key for manual entry"},"qr_code":{"type":"string","title":"Qr Code","description":"Base64 encoded QR code image"},"manual_entry_code":{"type":"string","title":"Manual Entry Code","description":"TOTP secret for manual entry"}},"type":"object","required":["secret","qr_code","manual_entry_code"],"title":"MFASetupResponse","description":"Response for TOTP setup containing QR code and secret"},"MFAStatusResponse":{"properties":{"enabled":{"type":"boolean","title":"Enabled","description":"Whether MFA is enabled"},"setup_complete":{"type":"boolean","title":"Setup Complete","description":"Whether MFA setup is complete"},"backup_codes_remaining":{"type":"integer","title":"Backup Codes Remaining","description":"Number of unused backup codes"}},"type":"object","required":["enabled","setup_complete","backup_codes_remaining"],"title":"MFAStatusResponse","description":"Response showing MFA status for user"},"MFAVerifyRequest":{"properties":{"code":{"type":"string","maxLength":6,"minLength":6,"title":"Code","description":"6-digit TOTP code"}},"type":"object","required":["code"],"title":"MFAVerifyRequest","description":"Request to verify a TOTP code"},"PasswordResetConfirm":{"properties":{"token":{"type":"string","title":"Token"},"new_password":{"type":"string","title":"New Password"}},"type":"object","required":["token","new_password"],"title":"PasswordResetConfirm"},"PasswordResetRequest":{"properties":{"email":{"type":"string","title":"Email"}},"type":"object","required":["email"],"title":"PasswordResetRequest"},"RefreshTokenRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["refresh_token"],"title":"RefreshTokenRequest"},"RoleEnum":{"type":"string","enum":["admin","user","trader","read_only"],"title":"RoleEnum"},"SessionOut":{"properties":{"id":{"type":"integer","title":"Id"},"session_token":{"type":"string","title":"Session Token"},"user_id":{"type":"integer","title":"User Id"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"user_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Agent"},"is_active":{"type":"boolean","title":"Is Active"},"is_suspicious":{"type":"boolean","title":"Is Suspicious"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"last_activity":{"type":"string","format":"date-time","title":"Last Activity"}},"type":"object","required":["id","session_token","user_id","is_active","is_suspicious","created_at","last_activity"],"title":"SessionOut"},"SessionTerminate":{"properties":{"session_id":{"type":"integer","title":"Session Id"},"message":{"type":"string","title":"Message","default":"Session terminated"}},"type":"object","required":["session_id"],"title":"SessionTerminate"},"SuspiciousActivityCreate":{"properties":{"session_id":{"type":"integer","title":"Session Id"},"activity_type":{"type":"string","title":"Activity Type"},"details":{"anyOf":[{},{"type":"null"}],"title":"Details"},"severity":{"type":"string","title":"Severity"}},"type":"object","required":["session_id","activity_type","severity"],"title":"SuspiciousActivityCreate"},"TokenPairResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"},"refresh_token":{"type":"string","title":"Refresh Token"},"refresh_token_expires_in":{"type":"integer","title":"Refresh Token Expires In"}},"type":"object","required":["access_token","expires_in","refresh_token","refresh_token_expires_in"],"title":"TokenPairResponse"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"}},"type":"object","required":["access_token","expires_in"],"title":"TokenResponse"},"TokenValidationResponse":{"properties":{"valid":{"type":"boolean","title":"Valid"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"roles":{"items":{"type":"string"},"type":"array","title":"Roles","default":[]},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["valid"],"title":"TokenValidationResponse"},"UserCreate":{"properties":{"username":{"type":"string","title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"disabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Disabled","default":false},"mfa_enabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mfa Enabled","default":false},"mfa_setup":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mfa Setup","default":false},"password":{"type":"string","title":"Password"},"roles":{"items":{"$ref":"#/components/schemas/RoleEnum"},"type":"array","title":"Roles","default":["user"]}},"type":"object","required":["username","email","password"],"title":"UserCreate"},"UserOut":{"properties":{"username":{"type":"string","title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"disabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Disabled","default":false},"mfa_enabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mfa Enabled","default":false},"mfa_setup":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mfa Setup","default":false},"id":{"type":"integer","title":"Id"},"roles":{"items":{"type":"string"},"type":"array","title":"Roles"}},"type":"object","required":["username","email","id","roles"],"title":"UserOut"},"UserUpdate":{"properties":{"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Password"},"disabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Disabled"},"roles":{"anyOf":[{"items":{"$ref":"#/components/schemas/RoleEnum"},"type":"array"},{"type":"null"}],"title":"Roles"}},"type":"object","title":"UserUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"auth__models__user__APIKeyCreate":{"properties":{"description":{"type":"string","title":"Description"},"exchange":{"type":"string","title":"Exchange"},"is_test":{"type":"boolean","title":"Is Test","default":false}},"type":"object","required":["description","exchange"],"title":"APIKeyCreate"},"auth__schemas__api_key__APIKeyCreate":{"properties":{"description":{"type":"string","title":"Description","description":"Description of the key's purpose"},"exchange":{"type":"string","title":"Exchange","description":"Exchange this key is for"},"is_test":{"type":"boolean","title":"Is Test","description":"Whether this is a test key","default":false},"expiry_days":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Expiry Days","description":"Days until key expires","default":90}},"type":"object","required":["description","exchange"],"title":"APIKeyCreate","description":"Request to create a new API key"},"auth__schemas__api_key__APIKeyResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Unique identifier for the key"},"key":{"type":"string","title":"Key","description":"The API key value"},"description":{"type":"string","title":"Description","description":"Description of the key's purpose"},"exchange":{"type":"string","title":"Exchange","description":"Exchange this key is for"},"is_test":{"type":"boolean","title":"Is Test","description":"Whether this is a test key"},"status":{"$ref":"#/components/schemas/KeyStatus","description":"Current status of the key"},"version":{"type":"integer","title":"Version","description":"Version number of the key"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"When the key was created"},"expires_at":{"type":"string","format":"date-time","title":"Expires At","description":"When the key expires"},"last_used":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Used","description":"When the key was last used"},"permissions":{"items":{"type":"string"},"type":"array","title":"Permissions","description":"Permissions granted to this key"},"rotated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Rotated At","description":"When the key was rotated"},"grace_period_ends":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Grace Period Ends","description":"When the grace period ends"},"next_key_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Next Key Id","description":"ID of the next key version"},"previous_key_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Previous Key Id","description":"ID of the previous key version"},"revoked_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Revoked At","description":"When the key was revoked"},"revocation_reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Revocation Reason","description":"Reason for revocation"},"compromised_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Compromised At","description":"When the key was marked compromised"},"compromise_details":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Compromise Details","description":"Details about the compromise"}},"type":"object","required":["id","key","description","exchange","is_test","status","version","created_at","expires_at","permissions"],"title":"APIKeyResponse","description":"Response containing API key details"},"auth__schemas__token__APIKeyResponse":{"properties":{"api_key":{"type":"string","title":"Api Key"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"},"permissions":{"items":{"type":"string"},"type":"array","title":"Permissions","default":[]}},"type":"object","required":["api_key","created_at"],"title":"APIKeyResponse"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/auth/login"}}}}}}